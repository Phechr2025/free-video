
{% extends "base.html" %}
{% block title %}อัปโหลดวิดีโอ (A+B+C){% endblock %}

{% block content %}
<h1>อัปโหลดวิดีโอใหม่</h1>

<form method="post" class="form" enctype="multipart/form-data">
  <label for="title">ชื่อวิดีโอ *</label>
  <input type="text" id="title" name="title" required />

  <label for="description">คำอธิบาย</label>
  <textarea id="description" name="description" rows="4"></textarea>

  <label for="thumbnail_url">ลิงก์รูปปก (ไม่บังคับ)</label>
  <input type="url" id="thumbnail_url" name="thumbnail_url" />

  <hr class="divider" />

  <p class="form-section-title">เลือกโหมดแหล่งที่มาของวิดีโอ</p>

  <div class="mode-selector">
    <label>
      <input type="radio" name="mode" value="direct" checked />
      โหมด A: ลิงก์ mp4 โดยตรง
    </label>
    <label>
      <input type="radio" name="mode" value="gdrive" />
      โหมด B: Google Drive (ใช้ gdown)
    </label>
    <label>
      <input type="radio" name="mode" value="upload" />
      โหมด C: อัปโหลดไฟล์ mp4 จากเครื่อง
    </label>
  </div>

  <div class="mode-block" id="mode-direct">
    <label for="video_url">ลิงก์วิดีโอ (ไฟล์ .mp4 หรือ URL ที่เล่นได้) *</label>
    <input type="url" id="video_url" name="video_url" />
  </div>

  <div class="mode-block" id="mode-gdrive" style="display:none;">
    <label for="drive_link">ลิงก์หรือไฟล์ไอดีของ Google Drive *</label>
    <input type="text" id="drive_link" name="drive_link" />
    <p class="hint">
      ตัวอย่างลิงก์: https://drive.google.com/file/d/FILE_ID/view?usp=sharing
      หรือกรอกเฉพาะ FILE_ID ก็ได้
    </p>
  </div>

  <div class="mode-block" id="mode-upload" style="display:none;">
    <label for="file">เลือกไฟล์วิดีโอ (.mp4) *</label>
    <input type="file" id="file" name="file" accept="video/mp4" />
  </div>

  <button type="submit" class="btn primary">บันทึกวิดีโอ</button>
</form>

<script>
  const radios = document.querySelectorAll('input[name="mode"]');
  const blockDirect = document.getElementById("mode-direct");
  const blockGdrive = document.getElementById("mode-gdrive");
  const blockUpload = document.getElementById("mode-upload");

  function updateMode() {
    const value = document.querySelector('input[name="mode"]:checked').value;
    blockDirect.style.display = value === "direct" ? "block" : "none";
    blockGdrive.style.display = value === "gdrive" ? "block" : "none";
    blockUpload.style.display = value === "upload" ? "block" : "none";
  }

  radios.forEach(r => r.addEventListener("change", updateMode));
  updateMode();
</script>
{% endblock %}
